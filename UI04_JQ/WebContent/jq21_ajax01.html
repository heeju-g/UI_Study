<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style type="text/css">
	*{
		margin: 0px;
		padding: 0px;
	}
	table{
		width:400px;
	}
	table tr:nth-child(odd){
		background-color: orange;
	}
	fieldset{
		width: 400px;
	}
	body{
		width: 1000px;
		margin: 50px auto;
	}
</style>
<script type="text/javascript" src="resources/js/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
	$(function(){
		$("#emp_list").click(function(){
			//사원번호 입력받은 것
			var empid = $("input[name=empid]").val();
			//입력받은게 숫자이고 3자리 수 라면
			if(!isNaN(empid) && empid.length == 3){
				$.ajax({
					
					url: "emplist.xml", 		//통신할(요청할) 서버(데이터) 주소
					method: "get", 				//전송 방식 get/post
					async: true,				 // default: true 비동기 / false 동기
					dataType: "xml",			 // 응답받은 데이터의 형식type : xml, json, html, script, text
					// data: {"key": "value", "key": "value"} // 전송할 데이터
					
					success: function(data){ 		//통신이 성공했을 때 실행할 함수
						var empinfo = $(data).find("EMPLOYEE_ID:contains("+empid+")").parent(); //parent는 row임
						if((empinfo).is("ROW")){ 
							$("table input").each(function(i){
								//row의 자식인 애들 하나하나 가져와서 값 넣어준단 소리(id, name, email등등)
								$(this).val($(empinfo).children().eq(i).text());
							});
						}else{//부모가 row가 아니라면 값이 없단 소리
							alert("검색대상이 존재하지 않습니다.")
						}
					},
					error: function(request,error){
						alert("code:"+request.status+"\n\n"+
								"message"+request.responseText+"\n\n"+
								"error:"+error);
					}
				});
			}else{
				alert("사원번호를 다시 입력하세요")
			}
		});
	});
</script>
</head>
<body>

<!-- 
	ajax : Asynchronous javascript amd xml
	서버 처리를 기다리지 않고, 비동기요청
 -->
 	<h1>데이터 가져오기</h1>
	<fieldset>
		<legend>사원정보 조회</legend>
		<input type="text" name="empid"/>
		<input type="button" id="emp_list" value="조회"/>
	</fieldset>
	<table>
		<tr>
			<th>사원번호</th>
			<td><input type="text" name="empnum"/>
		</tr>
		<tr>
			<th>이름</th>
			<td><input type="text" name="lastname"/>
		</tr>
		<tr>
			<th>이메일</th>
			<td><input type="text" name="email"/>
		</tr>
		<tr>
			<th>전화번호</th>
			<td><input type="text" name="phone"/>
		</tr>
		<tr>
			<th>입사일</th>
			<td><input type="text" name="hire"/>
		</tr>
		
	</table>
</body>
</html>